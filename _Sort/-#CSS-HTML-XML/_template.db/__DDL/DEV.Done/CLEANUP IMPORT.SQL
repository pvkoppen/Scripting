USE ACTOOLS
GO
SELECT * FROM AC_PERSON_TBL
SELECT * FROM AC_EXTERNALPERSID
SELECT * FROM ACCONFIGBASE

BEGIN TRAN
DELETE FROM AC_PERSON_TBL      WHERE CONVERT(INTEGER, PERSID) > 1008
DELETE FROM AC_EXTERNALPERSID  WHERE EFFDT > '2002-12-15'
DELETE FROM AC_EXTERNALPERSID  WHERE PERSID > '00001008'

DELETE FROM AC_PERSADDR_EFFDT  WHERE EFFDT > '2002-12-15'
DELETE FROM AC_PERSEMAIL_EFFDT WHERE EFFDT > '2002-12-15'
DELETE FROM AC_PERSNAME_EFFDT  WHERE EFFDT > '2002-12-15'
DELETE FROM AC_PERSPHONE_EFFDT WHERE EFFDT > '2002-12-15'

UPDATE ACCONFIGBASE SET PERSID_LAST = '1008'

SELECT * FROM AC_PERSON_TBL WHERE CONVERT(INTEGER, PERSID) > 1008
SELECT * FROM AC_EXTERNALPERSID
SELECT * FROM AC_PERSADDR_EFFDT
SELECT * FROM AC_PERSEMAIL_EFFDT
SELECT * FROM AC_PERSNAME_EFFDT
SELECT * FROM AC_PERSPHONE_EFFDT

--COMMIT
ROLLBACK
GO
/*
INSERT INTO AC_PERSON_TBL (PERSID)
SELECT DISTINCT PERSID FROM AC_EXTERNALPERSID
*/
GO
/*
SELECT EFFDT, COUNT(*) FROM AC_EXTERNALPERSID  GROUP BY EFFDT
SELECT EFFDT, COUNT(*) FROM AC_PERSADDR_EFFDT  GROUP BY EFFDT
SELECT EFFDT, COUNT(*) FROM AC_PERSEMAIL_EFFDT GROUP BY EFFDT
SELECT EFFDT, COUNT(*) FROM AC_PERSNAME_EFFDT  GROUP BY EFFDT
SELECT EFFDT, COUNT(*) FROM AC_PERSPHONE_EFFDT GROUP BY EFFDT
*/

