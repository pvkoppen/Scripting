var Forums={};Forums.Constants={ExpandCollapseImage:'<img src="'+ForumsRes.url_transGif+'" class="expcol"/>',ExpandCollapseLink:'<a class="expcol" href="javascript:void(0);"/>',ExpandCollapseImageRef:"img.expcol",ExpandCollapseLinkRef:"a.expcol"};Forums.Rte={IsOpen:false,IsReady:false,canShow:function(a){if(Forums.Rte.IsOpen===false)return true;a===true&&alert(ForumsRes.rte_alreadyOpen);return false},show:function(){if(Forums.Rte.IsOpen===true)return false;setTimeout(function(){Forums.Rte.IsReady=true},ForumsRes.rte_readyDelay);Forums.Rte.IsOpen=true;return true},hide:function(){Forums.Rte.IsOpen=false;Forums.Rte.IsReady=false},isBodyLengthValid:function(b){var a=0;if(b!==null&&Forums.Rte.trimString(b)!=="")a=b.length;if(a<4||a>6e4){alert(ForumsRes.rte_msgBodyLength);return false}else return true},trimString:function(a){var b=a.replace(/(\&nbsp\;)+/g," ");return b.replace(/^\s+|\s+$/g,"")},isUnTrustedUserPostValid:function(a){var b=Forums.Rte.getImageCount(a),c=Forums.Rte.getLinkCount(a);return b==0&&c==0},getImageCount:function(b){var c=new RegExp("<img+.*?((/>)|(</img>))","ig"),a=b===null||Forums.Rte.trimString(b)===""?0:b.match(c);if(a==null)a=0;return a},getLinkCount:function(b){var c=new RegExp("<a+.*?((/>)|)","ig"),a=b===null||Forums.Rte.trimString(b)===""?0:b.match(c);if(a==null)a=0;return a},isBodyImageCountValid:function(f){var c=0,e=new RegExp("Forums/getfile/?[0-9]*","ig"),a=Forums.Rte.getImageCount(f);if(a!==null&&a.length>0)for(var b=0;b<a.length;b++){var d=a[b].match(e);if(d!==null&&d.length>0)c++}return c>ForumsRes.rte_MaxAttachments?false:true},UnPrettifyCodeBlocks:function(a){$("pre.prettyprint",a).each(function(){$(this).removeClass("prettyprinted");$("span",$(this)).each(function(){$(this).replaceWith(function(){return $(this).contents()});$(this).html($("<div/>").text($(this).html()).html())})})}};Forums.Filters={decorateFilters:function(){var a=$(this);$("h6",this).prepend(Forums.Constants.ExpandCollapseLink);$("h6",this).click(function(){$(a).children("div.content").children("div.advanced").slideToggle("fast");$(a).toggleClass("expanded")});$("h6",this).mouseover(function(){$(a).addClass("hover")});$("h6",this).mouseout(function(){$(a).removeClass("hover")});$("div.advanced li a",this).hasClass("selected")&&$("h6",this).click()}};Forums.Message={autoSubscribeValue:function(d){var a=false;try{a=pageData.autoSubscribe;if(!a){var b=$(d).parents("li.thread");if(b!=null&&b.length>0){if($("h3 > img",b).hasClass("alert"))a=true}else{var c=$("ul.thread.menu > li > a[name='unsubscribe']");if(c!=null&&c.length>0)a=true}}}catch(e){}return a?"checked='checked'":""},edit:function(){var a=$(this).parents("li.message");$(this).click(function(){if(!Forums.Rte.canShow(true))return false;var c=$(a).attr("id")+"body",d="<textarea class='rte' id='"+c+"'></textarea>",b=$("div.body",a);Forums.Rte.UnPrettifyCodeBlocks(b);var e=$("#"+$(a).attr("id")+"_attachments").attr("value");$("div.quote",b).wrap("<blockquote/>");var g=$(b).html()+"<br/>";$.ajax({type:"POST",async:false,url:ForumsRes.get_editorUrl,data:{Id:$(a).attr("id"),body:g},success:function(a){d=a}});$(b).hide();$("div.helpful, ul.history, div.abusive, div.menu, div.votingouterbox, div.voting,span.votinglabel",a).hide();var f="<div class='editor'><form>"+d+"<input type='hidden' name='attachmentIds' value='"+e+"'/></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>&nbsp;<label>"+ForumsRes.rte_reasonLabel+"</label><input type='text' name='reason'/></div><div class='ajaxError submitEditError'></div></div>";$(b).after(f);Forums.Rte.show();$("button[name='submit']",a).click(Forums.Message.submitEdit(a,$(this).attr("url")));$("button[name='cancel']",a).click(function(){Forums.Rte.hide();$("#"+c).data("tEditor")!==undefined&&$("#"+c).data("tEditor").window.focus();$("div.editor",a).remove();$(b).show();$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",a).show();prettyPrint()});$("button[name='submit']",a).get(0).scrollIntoView(false);return false})},reply:function(){var a=$(this).parents("li.message");$(this).click(function(){if(!Forums.Rte.canShow(true))return false;var d=$(a).attr("id")+"body",c="<textarea class='rte' id='"+d+"'></textarea>";$.ajax({type:"POST",async:false,url:ForumsRes.get_editorUrl,data:{Id:$(a).attr("id")},success:function(a){c=a}});c=c.replace("if (!$.browser.msie || ($.browser.msie && $.browser.version >= 9))","if (!$.browser.msie || ($.browser.msie && $.browser.version >= 9 && document.documentMode >= 9))");var b="<div class='editor'><form>"+c+"<input type='hidden' name='attachmentIds'/></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>";if(userEmailConfigured)b=b+"&nbsp;<input type='checkbox' name='subscribe' "+Forums.Message.autoSubscribeValue(a)+"/><label>"+ForumsRes.rte_subscribeText+"</label>";b+="<div><div class='submitReplyError ajaxerror'></div></div>";b=b+"</div></div>";$(a).append(b);Forums.Rte.show();$("button[name='submit']",a).click(Forums.Message.submitReply(a,$(this).attr("url")));$("button[name='cancel']",a).click(function(){Forums.Rte.hide();$("#"+d).data("tEditor")!==undefined&&$("#"+d).data("tEditor").window.focus();$("div.editor",a).remove()});$("button[name='submit']",a).get(0).scrollIntoView(false);return false})},quote:function(){var a=$(this).parents("li.message");$(this).click(function(){if(!Forums.Rte.canShow(true))return false;var g=$(a).attr("id")+"body",i="<textarea class='rte' id='"+g+"'></textarea>",e=$("div.body",a);e=e.clone();Forums.Rte.UnPrettifyCodeBlocks(e);var b=$(e).html(),d="<blockquote>",f="</blockquote>";if(b.substring(0,d.length)===d){b=b.replace(d,"<p>");var h=b.lastIndexOf(f);b=b.substring(0,h)+"</p>"+b.substring(h+f.length)}b=d+b+f+"<br/>";$.ajax({type:"POST",async:false,url:ForumsRes.get_editorUrl,data:{Id:$(a).attr("id"),body:b},success:function(a){i=a}});var j=$("div.helpful",a),c="<div class='editor'><form>"+i+"<input type='hidden' name='attachmentIds' value='' /></form><div class='commands'><button name='submit'>"+ForumsRes.rte_submitText+"</button><button name='cancel'>"+ForumsRes.rte_cancelText+"</button>";if(userEmailConfigured)c=c+"&nbsp;<input type='checkbox' name='subscribe' "+Forums.Message.autoSubscribeValue(a)+"/><label>"+ForumsRes.rte_subscribeText+"</label>";c=c+"</div></div>";$(a).append(c);Forums.Rte.show();$("button[name='submit']",a).click(Forums.Message.submitReply(a,$(this).attr("url")));$("button[name='cancel']",a).click(function(){Forums.Rte.hide();$("#"+g).data("tEditor")!==undefined&&$("#"+g).data("tEditor").window.focus();$("div.editor",a).remove()});$("button[name='submit']",a).get(0).scrollIntoView(false);return false})},submitEdit:function(a,b){return function(){var e=$("div.editor",a),h=$(a).attr("id")+"body",c=$("#"+h),d=c[0].nodeName.toLowerCase();if(d==="table"&&c.data("tEditor")===undefined)return false;$("div.editor button",a).attr("disabled","disabled");var f=d==="table"?c.data("tEditor").value():c.val();if($("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(f)){alert(ForumsRes.MessageBodyUnTrustedUser);$("button[name='submit']",a).attr("disabled",false);$("button[name='cancel']",a).attr("disabled",false);return false}if(!Forums.Rte.isBodyLengthValid(f)){$("button[name='submit']",a).attr("disabled",false);$("button[name='cancel']",a).attr("disabled",false);return false}$(e).append('<div class="submitting"></div>');$(e).addClass("submitting");var i=$("div.editor > div.commands > input[name='reason']",a).val(),g=$("div.editor input[name='attachmentIds']",a).attr("value");$.ajax({type:"POST",url:b,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),body:f,reason:i,attachmentIds:g},success:function(b){if(typeof b=="object"&&b.StatusCode=="500")Forums.Common.ShowPrompt(b.Message,b.Confirm,b.Redirect);else{Forums.Rte.hide();d==="table"&&c.data("tEditor").window.focus();$("div.editor",a).remove();$(a).after(b).next().hide().fadeIn("fast").each(Forums.Message.decorateMessage);prettyPrint();$(a).remove()}},error:function(b){$("div.submitting",e).remove();$("div.editor button",a).removeAttr("disabled");alert(b.responseText)}})}},submitReply:function(a,b){return function(){var e=$("div.editor",a),h=$(a).attr("id")+"body",c=$("#"+h),d=c[0].nodeName.toLowerCase();if(d==="table"&&c.data("tEditor")===undefined)return false;$("div.editor button",a).attr("disabled","disabled");var f=d==="table"?c.data("tEditor").value():c.val();if($("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(f)){alert(ForumsRes.MessageBodyUnTrustedUser);$("button[name='submit']",a).attr("disabled",false);$("button[name='cancel']",a).attr("disabled",false);return false}if(!Forums.Rte.isBodyLengthValid(f)){$("button[name='submit']",a).attr("disabled",false);$("button[name='cancel']",a).attr("disabled",false);return false}$(e).append('<div class="submitting"></div>');$(e).addClass("submitting");var g=$("div.editor input[name='attachmentIds']",a).attr("value"),i=$("div.editor > div.commands > input[name='subscribe']",a).is(":checked");$.ajax({type:"POST",url:b,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),body:f,attachmentIds:g,subscribe:i},success:function(b){if(typeof b=="object"&&b.StatusCode=="500")Forums.Common.ShowPrompt(b.Message,b.Confirm,b.Redirect);else{Forums.Rte.hide();d==="table"&&c.data("tEditor").window.focus();$("div.editor",a).remove();$(a).after(b).next().hide().fadeIn("fast").addClass("new").each(Forums.Message.decorateMessage);prettyPrint()}},error:function(b){$("div.submitting",e).remove();$("div.editor button",a).removeAttr("disabled");$("div.submitReplyError").html(b.responseText).show()}})}},messageAction:function(a,b){return function(){var c=$(a).parents("li.message"),d=$(c).attr("id");$(c).append('<div class="submitting"></div>');$(c).addClass("submitting");b.__RequestVerificationToken=Forums.Message.AddAntiForgeryToken();if($(a).attr("url"))url=$(a).attr("url");else url=$(a).attr("href");$.ajax({type:"POST",url:url,data:b,success:function(b){if($(a).find(".messageContentContainer").length==0){$("li.message[id='"+d+"']").replaceWith(b);$("li.message[id='"+d+"']").each(Forums.Message.decorateMessage)}else{var a=$("li.message[id='"+d+"']"),f=$(b).find(".messageContentContainer").html(),e=$(b).closest("li.message[id='"+d+"']").attr("class");$(a).find(".messageContentContainer").html(f);$(a).each(Forums.Message.decorateMessage);e&&$(a).attr("class",e);$(c).removeClass("submitting")}},error:function(a){$("div.submitting",c).remove();alert(a.responseText)}});return false}},promptAction:function(a,c,b){return function(){Forums.HTML.createPopup(c);$("#okButton").click(function(){b.reason=$("#reason").attr("value");Forums.Message.messageAction(a,b)();var c=$(a).parents("li.message");$(".menu.message",c).get(0).scrollIntoView(false);$("#mask, .window").hide()});$("#reason").keypress(function(a){a.which==13&&$("#okButton").click()});$("#cancelButton").click(function(){var b=$(a).parents("li.message");$(".menu.message",b).get(0).scrollIntoView(false);$("#mask, .window").hide()});$("#closeButton").click(function(){var b=$(a).parents("li.message");$(".menu.message",b).get(0).scrollIntoView(false);$("#mask, .window").hide()});return false}},answer:function(){$(this).click(Forums.Message.messageAction($(this),{isAnswer:true}))},unanswer:function(){$(this).click(Forums.Message.messageAction($(this),{isAnswer:false}))},proposeAnswer:function(){$(this).click(Forums.Message.messageAction($(this),{isProposed:true}))},unproposeAnswer:function(){$(this).click(Forums.Message.messageAction($(this),{isProposed:false}))},clearAbuse:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_clearAbuseReason,{isAbuse:false}))},reportAbuse:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_reportAbuseReason,{isAbuse:true}))},deleteMessage:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_deleteReason,{isDeleted:true}))},undeleteMessage:function(){$(this).click(Forums.Message.promptAction(this,ForumsRes.prompt_undeleteReason,{isDeleted:false}))},gotoUrl:function(){$(this).click(function(){window.location=$(this).attr("url")});return false},voteHelpful:function(){var a=$(this);$(this).click(function(){$(a).fadeOut("fast");var b=$(a).parents("li.message");$("div.helpful > span > img",b).addClass("submitting");$.ajax({type:"POST",url:$(a).attr("href"),data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),isHelpful:true},dataType:"json",success:function(a){$("div.helpful > span > span",b).text(a.Votes);$("div.helpful > span > img",b).removeClass("submitting")},error:function(a){$("div.helpful > span > img",b).removeClass("submitting");alert(a.responseText)}});return false})},voteUp:function(){$(this).click(Forums.Message.messageAction($(this),{isHelpful:true}))},voteDown:function(){$(this).click(Forums.Message.messageAction($(this),{isHelpful:false}))},decorateMessage:function(){if(typeof pageData=="undefined"||pageData==null||pageData.validUser==false){var b=$("div.menu.message",this);$("a[name='reply']",b).each(Forums.Message.gotoUrl);$("a[name='quote']",b).each(Forums.Message.gotoUrl);$("div.helpful a.vote",this).each(Forums.Message.gotoUrl);return}$("a[name='reportAbuse']",this).each(Forums.Message.reportAbuse);$("a[name='clearAbuse']",this).each(Forums.Message.clearAbuse);$("div.helpful a.vote",this).each(Forums.Message.voteHelpful);$("a[name='voteup']",this).each(Forums.Message.voteUp);$("a[name='votedown']",this).each(Forums.Message.voteDown);var a=$("div.menu.message",this);$("a[name='setAnswer']",a).each(Forums.Message.answer);$("a[name='unsetAnswer']",a).each(Forums.Message.unanswer);$("a[name='proposeAnswer']",a).each(Forums.Message.proposeAnswer);$("a[name='unproposeAnswer']",a).each(Forums.Message.unproposeAnswer);$("a[name='reply']",a).each(Forums.Message.reply);$("a[name='quote']",a).each(Forums.Message.quote);$("a[name='edit']",a).each(Forums.Message.edit);$("a[name='delete']",a).each(Forums.Message.deleteMessage);$("a[name='undelete']",a).each(Forums.Message.undeleteMessage);$("a[name='split']",a).each(Forums.Message.gotoUrl);$("a.popup").popup()},AddAntiForgeryToken:function(){return $("#__AjaxAntiForgeryForm input[name='__RequestVerificationToken']").attr("value")}};Forums.HTML={createPopup:function(e){if($("#boxes").length>0){$("#mask").remove();$("#dialog").remove();$("#boxes").remove()}var d="<div id='boxes'><div id='dialog' class='window'><div class='poupTitle'><label id='resonLabel'>"+e+"</label><img title='Close' id='closeButton' class='icon delete' src=\""+ForumsRes.url_transGif+"\" complete='complete' ></img></div><div style='padding:0px 5px 10px 5px;'><span class='textSpan'><input type='text' id='reason' name='reason' value='' /></span><span class='buttonSpan'><button id='okButton' name='ok' >"+ForumsRes.rte_OKText+"</button><button id='cancelButton' name='cancel' > "+ForumsRes.rte_cancelText+"</button></span></div></div><div id='mask'></div></div>";$("body").append(d);var a="#dialog",c="#mask";$("#reason").select();$("#reason").focus();var f=($(window).height()-$(a).height())/2+$(window).scrollTop(),b=($(window).width()-$(a).width())/2+$(window).scrollLeft();$(a).css({top:f,left:b>0?b:0,display:"block"});this.addAnimation(a);$(c).css({top:0,left:0,width:$(document).width(),height:$(document).height()});$(c).fadeTo("fast",.5)},addAnimation:function(a){$(window).resize(function(){var c=($(window).height()-$(a).height())/2+$(window).scrollTop(),b=($(window).width()-$(a).width())/2+$(window).scrollLeft();$(a).css({top:c,left:b>0?b:0})});$(window).scroll(function(){var c=($(window).height()-$(a).height())/2+$(window).scrollTop(),b=($(window).width()-$(a).width())/2+$(window).scrollLeft();$(a).css({top:c,left:b>0?b:0})})}};Forums.Thread={threadAction:function(a,b){return function(){$("img.icon",a).addClass("submitting");b.__RequestVerificationToken=Forums.Message.AddAntiForgeryToken();if($(a).attr("url"))url=$(a).attr("url");else url=$(a).attr("href");$.ajax({type:"POST",url:url,data:b,dataType:"json",success:function(a){window.location=a.url},error:function(b){$("img.icon",a).removeClass("submitting");alert(b.responseText)}});return false}},promptAction:function(b,c,a){return function(){Forums.HTML.createPopup(c);$("#okButton").click(function(){if(a.stickyDate==""){var c=$("#reason").attr("value");if(Forums.Thread.isStickyDateValid(c))a.stickyDate=$("#reason").attr("value");else{$("#reason").val("");alert(ForumsRes.StickyDateInValid);return false}}else a.reason=$("#reason").attr("value");Forums.Thread.threadAction(b,a)();var d=$(b).parents("li.message.root");$(".menu.thread",d).get(0).scrollIntoView(false);$("#mask, .window").hide()});$("#reason").keypress(function(a){a.which==13&&$("#okButton").click()});$("#cancelButton").click(function(){var a=$(b).parents("li.message.root");$(".menu.thread",a).get(0).scrollIntoView(false);$("#mask, .window").hide()});$("#closeButton").click(function(){var a=$(b).parents("li.message.root");$(".menu.thread",a).get(0).scrollIntoView(false);$("#mask, .window").hide()});return false}},AddAntiForgeryToken:function(){return $("#__AjaxAntiForgeryForm input[name='__RequestVerificationToken']").attr("value")},editThread:function(){var a=$(this).parents("li.message");$(this).click(function(){if(!Forums.Rte.canShow(true))return false;var c=$(a).attr("id")+"body",d="<textarea class='rte' id='"+c+"'></textarea>",g=$("#content h1 span[name='subject']").text(),b=$("div.body",a);Forums.Rte.UnPrettifyCodeBlocks(b);var e=$("#"+$(a).attr("id")+"_attachments").attr("value"),h=$(b).html()+"<br/>";$.ajax({type:"POST",async:false,url:ForumsRes.get_editorUrl,data:{Id:$(a).attr("id"),body:h},success:function(a){d=a}});$(b).hide();$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",a).hide();var f="<div class='editor'><label>"+ForumsRes.rte_subjectLabel+"</label> <input type='text' id='subject' size='60' /><form>"+d+"<input type='hidden' name='attachmentIds' value='"+e+"'/></form><div class='commands'><button id='submit'>"+ForumsRes.rte_submitText+"</button><button id='cancel'>"+ForumsRes.rte_cancelText+"</button>&nbsp;<label>"+ForumsRes.rte_reasonLabel+"</label><input type='text' id='reason'/></div><div><div class='submitEditError ajaxerror'></div></div></div>";$(b).after(f);$("#subject",a).val(g);Forums.Rte.show();$("#submit",a).click(Forums.Thread.submitEdit(a,$(this).attr("url")));$("#cancel",a).click(function(){Forums.Rte.hide();$("#"+c).data("tEditor")!==undefined&&$("#"+c).data("tEditor").window.focus();$("div.editor",a).remove();$(b).show();$("div.helpful, ul.history, div.abusive, div.menu,div.votingouterbox, div.voting,span.votinglabel",a).show();prettyPrint()});$("#submit",a).get(0).scrollIntoView(false);return false})},submitEdit:function(a,b){return function(){var g=$("div.editor"),f=$("div.editor",a),i=$(a).attr("id")+"body",c=$("#"+i),e=c[0].nodeName.toLowerCase();if(e==="table"&&c.data("tEditor")===undefined)return false;g.find("button").attr("disabled","disabled");var d=e==="table"?c.data("tEditor").value():c.val();if($("#trustedU").val().toLowerCase()==="false"&&$("#isTrustedCheckEnabled").val().toLowerCase()==="true"&&!Forums.Rte.isUnTrustedUserPostValid(d)){alert(ForumsRes.MessageBodyUnTrustedUser);$("#submit",a).attr("disabled",false);$("#cancel",a).attr("disabled",false);return false}if(!Forums.Rte.isBodyLengthValid(d)){$("#submit",a).attr("disabled",false);$("#cancel",a).attr("disabled",false);return false}if(!Forums.Rte.isBodyImageCountValid(d)){alert(ForumsRes.rte_MaxAttachmentsErrMsg);$("#submit",a).attr("disabled",false);$("#cancel",a).attr("disabled",false);return false}$(f).append('<div class="submitting"></div>');$(f).addClass("submitting");var k=g.find("#reason").val(),j=g.find("#subject").val(),h=$("div.editor input[name='attachmentIds']",a).attr("value");$.ajax({type:"POST",url:b,data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),subject:j,body:d,reason:k,attachmentIds:h},dataType:"json",success:function(b){if(typeof b=="object"&&b.StatusCode&&b.StatusCode=="500")Forums.Common.ShowPrompt(b.Message,b.Confirm,b.Redirect);else{e==="table"&&c.data("tEditor").window.focus();$("div.editor",a).remove();window.location=b.url}},error:function(b){$("div.submitting",f).remove();$("div.editor button",a).removeAttr("disabled");$("div.submitEditError").html(b.responseText).show()}})}},clearSticky:function(){$(this).click(Forums.Thread.threadAction(this,{stickyDate:""}))},deleteThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_deleteReason,{isDeleted:true}))},lock:function(){$(this).click(Forums.Thread.threadAction(this,{isLocked:true}))},makeSticky:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_stickyUntil,{stickyDate:""}))},subscribe:function(){$(this).click(Forums.Thread.threadAction(this,{isSubscribed:true}))},undeleteThread:function(){$(this).click(Forums.Thread.promptAction(this,ForumsRes.prompt_undeleteReason,{isDeleted:false}))},unlock:function(){$(this).click(Forums.Thread.threadAction(this,{isLocked:false}))},unsubscribe:function(){$(this).click(Forums.Thread.threadAction(this,{isSubscribed:false}))},join:function(){$(this).click(Forums.Thread.threadAction($(this),{isJoined:true}))},unjoin:function(){$(this).click(Forums.Thread.threadAction($(this),{isJoined:false}))},decorateThreadMenu:function(){$("a[name='delete']",this).each(Forums.Thread.deleteThread);$("a[name='undelete']",this).each(Forums.Thread.undeleteThread);$("a[name='editThread']",this).each(Forums.Thread.editThread);$("a[name='lock']",this).each(Forums.Thread.lock);$("a[name='unlock']",this).each(Forums.Thread.unlock);$("a[name='sticky']",this).each(Forums.Thread.makeSticky);$("a[name='clearSticky']",this).each(Forums.Thread.clearSticky);$("a[name='subscribe']",this).each(Forums.Thread.subscribe);$("a[name='unsubscribe']",this).each(Forums.Thread.unsubscribe);$("a[name='joinQuestion']").each(Forums.Thread.join);$("a[name='unJoinQuestion']").each(Forums.Thread.unjoin);$("a[name='move']").each(Forums.Message.gotoUrl);$("a[name='merge']").each(Forums.Message.gotoUrl);$("a[name='assign']").each(Forums.Message.gotoUrl);$("a[name='changeType']").each(Forums.Message.gotoUrl)},messagesLoaded:function(a){$(a).removeClass("loading");$(a).removeClass("hasUnread");$(a).removeClass("new");$(a).addClass("loaded");$(a).addClass("viewed");$("div.preview",a).append('<div class="links"></div>');var b=$("div.links",a);$(b).append('<a name="view"></a>');var e=$("a[name='view']",b),d=$("h3 a:eq(1)",a).attr("href");$(e).text(ForumsRes.thread_viewThreadText).attr("href",d).attr("title",ForumsRes.thread_viewThreadText);$(b).append('<a name="close"></a>');var c=$("a[name='close']",b);$(c).text(ForumsRes.thread_closePreviewText).attr("href","javascript:void(0)").attr("title",ForumsRes.thread_closePreviewText);$(c).click(function(){$("h3",a).click()});$("div.preview",a).slideToggle("fast");$("li.message",a).each(Forums.Message.decorateMessage);prettyPrint()},decorateThread:function(){var a=$(this);$("h3 > a",this).before(Forums.Constants.ExpandCollapseLink);$(this).append('<div class="preview"></div>');$("h3",this).click(function(c){if(c.target.nodeName.toLowerCase()==="a")if(c.target.className!=="expcol")return;$(a).toggleClass("expanded");if($(a).hasClass("loading"))return;if($(a).hasClass("loaded")){$("div.editor button[name='cancel']",a).click();$("div.preview",a).slideToggle("fast");return}$(a).addClass("loading");var b=$("h3:first > a:eq(1)",a).attr("href")+"/messages?time="+(new Date).getTime();b=b.substring(7);b=b.substring(b.indexOf("/"));$("div.preview",a).load(b,null,function(){Forums.Thread.messagesLoaded(a);$("li.message",this).profileWidgitize()})});$("h3",this).mouseover(function(){$(a).addClass("hover")});$("h3",this).mouseout(function(){$(a).removeClass("hover")})},isStickyDateValid:function(c){if(c.length!=10)return false;var a=c.split("-");if(a.length!=3)return false;var e="^[0-9]+$";for(i=0;i<3;i++)if(!a[i].match(e))return false;var b=new Date(a[0],a[1]-1,a[2]);if(b.getFullYear()!=a[0]||b.getMonth()!=a[1]-1||b.getDate()!=a[2])return false;var d=new Date;return b<d?false:true}};Forums.QuickLinks={wire:function(){$("#quickLinks").click(function(a){Forums.Homepage.toggleDropDown($(this),a)})}};Forums.Homepage={Actions:{Category:0,CategoryAll:1,CategoryViewAll:2,Filter:5,Sort:6,Search:7,Clear:8,FilterWithAllLanguages:9},wireTopBar:function(a){Forums.Homepage.searchWatermark=a;Forums.Homepage.wireFilterBar(a);Forums.ThreadPage.wireSearchBar(a);Forums.QuickLinks.wire()},wirePageElements:function(b,a){Forums.Homepage.wireThreadListView();Forums.Homepage.wireCategoryList(a);Forums.Homepage.wireForumList(a);Forums.Homepage.wireAnnouncements();Forums.Homepage.wireLeaderBoard();Forums.ThreadPage.attachTooltipHandler();Forums.Homepage.categoriesWatermark=b;$.addToRail(railItems);Forums.Homepage.getAllCategories()},rewirePageElements:function(){Forums.Toggler.setup();Forums.Homepage.wirePageElements(Forums.Homepage.categoriesWatermark,Forums.Homepage.searchWatermark)},rewireSearchElements:function(){Forums.Toggler.wireToggleButton();Forums.Homepage.wireFilterBar(Forums.Homepage.searchWatermark);Forums.Homepage.replaceSearchUrl();Forums.Homepage.replaceAnnouncements();Forums.Homepage.wireAnnouncements();Forums.Homepage.wireThreadListView();Forums.Homepage.addSelectedClassToSelectedCategoryHeaders();Forums.ThreadPage.attachTooltipHandler();Forums.Homepage.setCategoryScopingState()},replaceAnnouncements:function(){$("#topBarImportantInfoContainer").html($("#searchAnnouncmentContainer").html())},replaceSearchUrl:function(){$("#homesearchform").attr("action",$("#hdnSearchUrl").val())},getAllCategories:function(){var a=$("#allCategoryPopupContainer").data("url");a=Forums.AppendQuestionOrAmpersandToUrl(a)+"time="+(new Date).getTime();a&&$.ajax({url:a}).done(function(a){$("#allCategoryPopupContainer").html(a);Forums.Homepage.wireGetAllCategories()})},wireGetAllCategories:function(){Forums.Homepage.wireAllCategoriesBox(Forums.Homepage.categoriesWatermark);b();$("#submitAllCategories").click(function(b){a(b)});Forums.Homepage.wireCategoryListElements($("#allCategoryPopupContainer"));Forums.Homepage.setCategoryScopingState("#allCategoryListContainer");$("#allCategoryListContainer").find(".selectallcheckbox").change(function(){Forums.Homepage.selectAllForums($(this));Forums.Homepage.updateSelectedForumsCount()});$("#allCategoryListContainer").find('input[type="checkbox"]').change(function(){$("#allCategoriesListChanged").val(true);Forums.Homepage.updateSelectedForumsCount()});function b(){var a;$("#allCategoriesSearchContainer").find("#searchbox").keyup(function(){window.clearTimeout(a);var b="";if(!$(this).hasClass("watermark"))b=$(this).val();a=setTimeout(function(){c(b)},500);return false})}function a(a){Forums.Homepage.hideDropDown(a);$("#viewallCategoriesContainer").find(".arrowdown").addClass("invisible").removeClass("visible");$("#allCategoriesListChanged").val()=="true"&&Forums.Homepage.redirectHomePage($("#allCategoryListContainer"),$("#homePageFilterBarContainer"),Forums.Homepage.searchWatermark,Forums.Homepage.Actions.CategoryViewAll)}function c(a){if(Forums.Rte.trimString(a)!=="")$("#allCategoryPopupContainer").find(".categoryArea").each(function(){var c=$(this).find(".forumFilter"),d=$(this).find(".categoryHeaderText:first").html(),e=d.toUpperCase().indexOf(a.toUpperCase())!==-1,b=$(this).find(".checkboxText:Contains('"+a+"')");if(e){$(c).find(".forumItem").show();$(this).show()}else{$(b).each(function(){$(this).parents(".forumItem:first").show()});$(this).find(".checkboxText:not(:Contains('"+a+"'))").each(function(){$(this).parents(".forumItem:first").hide()});$(this).toggle(b.length>0)}if(b.length>0)Forums.Homepage.showForumList(c);else Forums.Homepage.hideForumList(c)});else{$("#allCategoryPopupContainer").find(".categoryArea").show();$("#allCategoryPopupContainer").find(".forumFilter").each(function(){Forums.Homepage.hideForumList($(this))});$("#allCategoryPopupContainer").find(".forumFilter:has(.chkForumSelector:checked)").each(function(){Forums.Homepage.showForumList($(this))});$("#allCategoryPopupContainer").find(".forumItem").show()}}},wireAskAQuestion:function(){var c=$(".btn.askQuestionLink","#msdn-technet-en-home"),d=Forums.Homepage.getSelectedForums($("#topCategoryItems")),a="",b="",e=$(c).data("askurlbase");if(d.length===1){b=d[0];a=$(".categoryHeader.selected:first").parents("li.categoryArea:first").data("categoryname")}var f=e+"?category="+a+"&forum="+b;$(c).attr("href",f)},wireThreadListView:function(){$("a.arrowdown",".threadsnippet").click(function(){Forums.Homepage.expandThread($(this))});var a=$("a.arrowdown",".threadsnippet.selected");$(a).length>0&&$(a).click();Forums.ForumDetails.wireAllBreadcrumbs()},wireAllCategoriesBox:function(a){$("#allCategoryListContainer").find(".forumItem").mouseover(function(){var a=$(this).parents(".categoryArea:first").data("categoryname");Forums.Homepage.loadForumDetails(a,$(this).data("forumname"))});$("#allCategoriesSearchContainer table.searchboxinnercontainer #searchbox").watermark(a)},wireCategoryListElements:function(a){var b="expanded";$(".categoryHeader",a).click(function(){var a=$("a.arrowdown",$(this));c($(a));return false});$(".forumFilter .checkboxText",a).click(function(){var a=$(this).siblings(".checkboxContainer").children("input[type='checkbox']");$(a).attr("checked",!$(a).attr("checked")).change()});function c(c){var e=$(c).parents(".categoryHeader",a).siblings(".forumFilter"),d=$(c).hasClass(b);$(e).toggle(!d);$(c).toggleClass(b)}},wireCategoryList:function(){Forums.Homepage.wireCategoryListElements($("#topCategoryItems"));$("#viewallCategoriesContainer").click(function(e){var a=$("#allCategoryPopupContainer");if($("#categoryOverlay").length<=0&&!($.browser.msie&&parseInt($.browser.version,10)<=7)){var c=$('<div id="categoryOverlay" class="homecategoryPopupOverlay"/>');$("body").append(c)}Forums.Homepage.updateSelectedForumsCount();if(!$(a).is(":visible")){var b=$(window).height()*.8-160;$("#categoriesListing").children("ul").height(b<400?b:400);var f=($(window).height()-a.height())/2,d=($(window).width()-a.width())/2;$("#categoryOverlay").css("height",$(document).height());$(a).css("left",d).css("top",f)}a.data("overlay","#categoryOverlay");Forums.Homepage.toggleDropDown($(a).parent(),e)});Forums.Homepage.setCategoryScopingState();$(".categoryArea").has(".chkForumSelector:checked").each(function(){$(this).find(".categoryHeader").addClass("selected")});Forums.Homepage.addSelectedClassToSelectedCategoryHeaders()},addSelectedClassToSelectedCategoryHeaders:function(){$(".categoryHeader").removeClass("selected");$(".categoryArea").has(".chkForumSelector:checked").each(function(){$(this).find(".categoryHeader").addClass("selected")})},setCategoryScopingState:function(a){a=a||$("#topCategoryItems");$(".chkForumSelector",a).attr("checked",false);d();c();e();function c(){var b=Forums.Homepage.getCurrentCategories();$(b).each(function(){var c=this.toLowerCase(),d=$(a+"[data-categoryname]").filter(function(){return $(this).attr("data-categoryname").toLowerCase()==c}),b=$(d).children(".forumFilter");$("input[type='checkbox']",$(b)).attr("checked",true);Forums.Homepage.showForumList(b)})}function d(){var b=Forums.Homepage.getCurrentForums();$(b).each(function(){var d=this.toLowerCase(),b=$(a+"[data-forumname]").filter(function(){return $(this).attr("data-forumname").toLowerCase()==d});$(".chkForumSelector",b).attr("checked",true);var c=$(b).parents(".forumFilter");!$(c).is(":visible")&&Forums.Homepage.showForumList(c)})}function e(){$(".forumFilter").each(function(){var a=b($(this));$(".selectallcheckbox",$($(this))).attr("checked",a)})}function b(b){var a=true,c=$(".forumItem",$(b));$(c).each(function(){var c=$(this).data("forumname");if(typeof c!=="undefined"&&c!==false){var b=$(".chkForumSelector",$(this)).is(":checked");if(b==="undefined"||b===false)a=false}});return a}},showForumList:function(a){Forums.Homepage.hideorShowForumList(a,true)},hideForumList:function(a){Forums.Homepage.hideorShowForumList(a,false)},hideorShowForumList:function(a,b){$(a).toggle(b);var c=$(a).siblings(".categoryHeader").find(".arrowdown");$(c).toggleClass("expanded",b)},updateSelectedForumsCount:function(){$("#totalselectedForums").html(" "+$("#categoriesListing input:checked").not(".selectallcheckbox").length+" ")},wireForumList:function(a){$("#topCategoryItems").find(".chkForumSelector").change(function(){var b=$(this).is(":checked");$($(".chkForumSelector[data-forumId='"+$(this).data("forumid")+"']")).each(function(){$(this).attr("checked",b)});Forums.Homepage.redirectHomePage($("#topCategoryItems"),$("#homePageFilterBarContainer"),a,Forums.Homepage.Actions.Category)});$(".forumFilter div.moreLink").click(function(){$(this).siblings(".allForumItems").show();$(this).hide();return false});$(".forumFilter div.lessLink").click(function(){$(this).parent().hide();return false});$("#topCategoryItems").find(".selectallcheckbox").change(function(){Forums.Homepage.selectAllForums($(this));Forums.Homepage.redirectHomePage($("#topCategoryItems"),$("#homePageFilterBarContainer"),a,Forums.Homepage.Actions.CategoryAll)});Forums.ForumDetails.wireForumItem()},wireFilterBar:function(a){$(".filterdropdown","#filterBar").click(function(a){Forums.Homepage.toggleFilterDropDown($(this),a)});$(".threadFilterItem").find(".chkFilterSelector").change(function(){if($(this).parents(".threadFilterItem:first").data("filter")=="alllanguages")Forums.Homepage.redirectHomePage($("#topCategoryItems"),$("#homePageFilterBarContainer"),a,Forums.Homepage.Actions.FilterWithAllLanguages);else Forums.Homepage.redirectHomePage($("#topCategoryItems"),$("#homePageFilterBarContainer"),a,Forums.Homepage.Actions.Filter)});$("#threadFilter").find(".checkboxText").click(function(){var a=$(this).siblings("input[type='checkbox']");$(a).attr("checked",!$(a).attr("checked")).change()});$(".radioButtonText").click(function(){var a=$(this).siblings('input[type="radio"]');$(a).attr("checked",!$(a).attr("checked")).change()});$("li.sortSelector").click(function(){$("#sortFilter").find(".selectedSort").each(function(){$(this).removeClass("selectedSort").addClass("unselectedSort")});$(this).removeClass("unselectedSort").addClass("selectedSort");Forums.Homepage.redirectHomePage($("#allCategoryListContainer"),$("#homePageFilterBarContainer"),a,Forums.Homepage.Actions.Sort)})},wireLeaderBoard:function(){Forums.Homepage.loadLeaderBoard(1)},wireAnnouncements:function(){$("#seeAnnouncementsLinkBox").click(function(a){Forums.Homepage.toggleDropDown($(this).parent(),a)});$("li.announcement .announcementContainer").click(function(){$(this).find("a.arrowdown").toggleClass("expanded");$(this).siblings(".announcementDetails").toggle()});$("li.announcement .linkAnnouncement").click(function(c){c.preventDefault();var a=$(this).parents("li.announcement"),b=$("div.linkContent",$(a));if(b.length>0)b.remove();else{b="<div class='linkContent'> <div style='margin-right: 4px;'><label>"+ForumsRes.Announcement_LinkToAnnouncement+"</label><a class='close' style='float:right;'>"+ForumsRes.Announcement_CloseText+"</a></div>  <div><input type='text' class='announcementUrl' readonly='readonly' value='"+$(this).attr("href")+"' /></div>  </div>";$(b).insertBefore($("div.announcementDetails",$(a)));$("a.close",a).click(function(b){b.stopPropagation();$("div.linkContent",a).remove()});$("input[type='text']",a).click(function(a){a.stopPropagation()}).focus()}});$("li.announcement .deleteAnnouncement").click(function(b){b.preventDefault();var a=$(this).parents(".announcement:first");$.ajax({type:"POST",url:$(this).attr("href"),data:{__RequestVerificationToken:Forums.Message.AddAntiForgeryToken(),isDeleted:true},success:function(){$(a).remove()}})});var a=$(".announcementContainer.selected");if($(a).length>0){$("#seeAnnouncementsLinkBox").click();$(a).click()}},getCurrentForums:function(){return Forums.GetJSONArray($("#hdnForums").val())},getCurrentCategories:function(){return Forums.GetJSONArray($("#hdnCategories").val())},selectAllForums:function(a){var b=$(a).parents("li.categoryArea:first").data("categoryid");$(".allForumItems_"+b).find(".chkForumSelector").attr("checked",$(a).is(":checked"))},getSelectedForums:function(b){var a=[];$(b).find(".chkForumSelector:checked").each(function(){a.push($(this).parents(".forumItem:first").data("forumname"))});return a},getSelectedForumsWithCategories:function(b){var a={};$(b).find("li.categoryArea").each(function(){var b=$(this).find(".chkForumSelector:checked");if(b.length>0){var e=$(this).find(".chkForumSelector").length,c=[];b.each(function(){c.push($(this).parents(".forumItem:first").data("forumname"))});var d=$(this).data("categoryname");a[d]={totalForums:e,forums:c}}});return a},redirectHomePage:function(n,f,o,l){Forums.Homepage.addSelectedClassToSelectedCategoryHeaders();Forums.Homepage.wireAskAQuestion();var h=Forums.Homepage.getSelectedForumsWithCategories(n),b=[],c=[];for(var g in h){var e=h[g];if(e.totalForums==e.forums.length)c.push(g);else b.push.apply(b,e.forums)}var k=[];$(f).find(".chkFilterSelector:checked").each(function(){var a=$(this).parents(".threadFilterItem:first").data("filter");k.push(a)});if(l==Forums.Homepage.Actions.FilterWithAllLanguages){b=Forums.Homepage.getCurrentForums();c=Forums.Homepage.getCurrentCategories()}var m=[];$(f).find("li.selectedSort").each(function(){m.push($(this).data("sort"))});var d=encodeURIComponent($("#threadsearchbarContainer input#searchbox").val()),i=$("#hdnUserName").val(),j=Forums.BaseUrl(),a=j;if(i)a+=(a.indexOf("?")>-1?"&":"?")+"user="+i;if(c.length>0)a=Forums.CommaSeparateAndAddListToUrl(a,"category",c);if(b.length>0)a=Forums.CommaSeparateAndAddListToUrl(a,"forum",b);a=Forums.CommaSeparateAndAddListToUrl(a,"filter",k);a=Forums.CommaSeparateAndAddListToUrl(a,"sort",m);if(d&&d!=encodeURIComponent(o))a+=(a.indexOf("?")>-1?"&":"?")+"searchTerm="+d;if(b.length==0&&c.length==0)a+=(a.indexOf("?")>-1?"&":"?")+"brandIgnore=true";Forums.Homepage.updateSignInOutLink(j,a);Forums.ClientRefresh.Controller.get(a,l)},updateSignInOutLink:function(e,f){var b=$("div.signIn a").attr("href"),d=/wreply=((https?.+?%2fForums%2f.+%2fhome).*?(%26|%3f))stoAI/gim,a=d.exec(b);if(a!=null){var c=a[2]+encodeURIComponent(f.replace(e,""))+"%26";$("div.signIn a").attr("href",b.replace(a[1],c))}},expandThread:function(a){var b=$(a).parents("div.threadsnippet:first").find("div.expandedThreadContainer"),c=$(a).parent().data("threadmessagesurl");$(a).toggleClass("expanded");$(b).toggle($(a).hasClass("expanded"));$(a).hasClass("expanded")&&Forums.Homepage.loadThreadPreview(b,c)},hideDropDown:function(a){$(".popup").each(function(){if(!$(this).find(a.target).length||$(a.target).hasClass("closePopup")){$(this).hide();$(this).data("overlay")&&$($(this).data("overlay")).hide()}})},toggleDropDown:function(d,b){var a=d.children(".popup"),c=!$(a).is(":visible");Forums.Homepage.hideDropDown(b);if(c){a.data("overlay")&&$(a.data("overlay")).toggle();a.toggle();b.stopPropagation();$("body").click(function(a){Forums.Homepage.hideDropDown(a)})}},toggleFilterDropDown:function(a,b){$(".filterdropdown","#filterBar").each(function(){$(a).attr("id")!=$(this).attr("id")&&$(this).children(".popup").hide()});Forums.Homepage.toggleDropDown(a,b)},loadThreadPreview:function(a,b){b=Forums.AppendQuestionOrAmpersandToUrl(b)+"time="+(new Date).getTime();$.ajax({type:"GET",beforeSend:function(){$(a).show()},url:b,success:function(b){$(a).html(b);$("#threadList").addClass("nowhitespace");prettyPrint();$("li.message",a).each(Forums.Message.decorateMessage)},error:function(){$(a).html('<div class="links"></div>');var b=$("div.links",a);$(b).append("<a class='view'></a>");var c=$(a).parent().find("h3 a.threadUrl").attr("href");$("a.view",b).text(ForumsRes.thread_viewThreadText).attr("href",c).attr("title",ForumsRes.thread_viewThreadText);$(b).append("<a class='close'></a>");$("a.close",b).text(ForumsRes.thread_closePreviewText).attr("href","javascript:void(0)").attr("title",ForumsRes.thread_closePreviewText).click(function(){$(a).hide()})}})},loadLeaderBoard:function(a){var b=$("#homepageLeaderboard");if(b.length===1){var c=Forums.AppendQuestionOrAmpersandToUrl($(b).data("leaderboardurl"));a++;if(a>4||a<2)a=2;var d=c+"leaderBoard="+a+"&rnd="+Math.random();$(b).addClass("submitting").load(d,null,function(){$(b).removeClass("submitting");$("a[name='seeMore']").click(function(){var a=$(this).data("nextindex");Forums.Homepage.loadLeaderBoard(a)})})}},loadForumDetails:function(d,c){var b="categoryDetails_"+d;if(!$("#"+b).length){var a=document.createElement("div");$(a).attr("id",b);$("#forumDetailsContainer").append(a);var e=$("#category_"+d).children(".categoryHeader").data("forumdetailsurl");$.getJSON(e,function(b){Forums.Homepage.loadForumDetailsForCategory(b,a,c)}).fail(function(c,b,a){$("#forumDetailsContainer").html("Error: "+a)})}else{$(".singleforumdetails").hide();$("#forumDetailsContainerBanner").hide();$("#forumdetails_"+c).show()}},loadForumDetailsForCategory:function(c,a,b){$.each(c,function(g,b){var c=$("#forumDetailsTemplate").clone().hide();$(c).attr("id","forumdetails_"+b.Name).attr("class","singleforumdetails");$(c).children("h3.header").prepend(b.DisplayName);$(c).children("div.content").html(b.Description);$(c).find("img.rss").parent().attr("href",b.RSSUrl);if(b.ShowManageForums){var e=$(c).find(".manageForumSection");$(e).find(".manageForumLink").attr("href",b.ManageForumUrl).text(b.ManageForumsText);$(e).find(".manageRolesLink").attr("href",b.ManageRolesUrl).text(b.ManageRolesText);$(e).show()}var d=$(c).find("a.addRemoveForum");$(d).attr("href",b.FavoriteUrl);if(b.HasFavoritePermission)$(d).attr("title",b.AddToMyForumsText).attr("name","favorite").attr("data-reverseText",b.RemoveFromMyForumsText).attr("data-reversename","unfavorite").text(b.AddToMyForumsText);else b.HasUnFavoritePermission===true&&$(d).attr("title",b.RemoveFromMyForumsText).attr("name","unfavorite").attr("data-reverseText",b.AddToMyForumsText).attr("data-reversename","favorite").text(b.RemoveFromMyForumsText);$(a).append(c);var f=$(d).attr("name");typeof f!=="undefined"&&f!==false&&$(d).show()});$(".singleforumdetails").hide();$("#forumdetails_"+b).show();$("#forumDetailsContainerBanner").hide();$(a).find("a.addRemoveForum").click(function(){var b=$(this).attr("name")==="favorite",a=$(this);$.post($(a).attr("href"),{isFavorited:b},function(f){if(f.success){var d=$(a).text(),c=$(a).attr("name"),b=$(a).data("reversetext"),e=$(a).data("reversename");$(a).attr("title",b).attr("name",e).attr("data-reversetext",d).attr("data-reversename",c);$(a).text(b)}},"json");return false})}};Forums.ThreadPage={wirePageElements:function(){this.attachTooltipHandler();this.getRelatedThreads()},wireSearchBar:function(a){$("#threadsearchbarContainer table.searchboxinnercontainer #searchbox").watermark(a)},getRelatedThreads:function(){var a=$("#relatedThreads").data("url");a&&$.ajax({url:a}).done(function(a){$("#relatedThreads").html(a)})},attachTooltipHandler:function(){$(".forumBreadcrumb").each(function(){$(this).hover(function(){var a=$(this).children(".breadcrumbTip");if(a){a.css("top","20px");a.css("left","0px");a.show()}},function(){var a=$(this).children(".breadcrumbTip");a&&a.hide()})})}};Forums.Toggler=function(){var a="ShowSidebar",b="#threadPageContentContainer #toggleSidebar",c="#allThreadsContainer #toggleSidebar",f="#threadPageSidebarContainer",d="#threadPageContentContainer",e="#threadPageContainer .messageContent",h="#homePageSidebarContainer",g="#homePageContentContainer",i=-1;function n(){if(!Modernizr.localstorage)localStorage={};($(b).length>0||$(c).length>0)&&l()}function m(b,e,c,d,f){if(localStorage[a]==="1"||typeof localStorage[a]==="undefined"){j(b,e,c,d,f);localStorage[a]=0}else{k(b,e,c,d,f);localStorage[a]=1}}function j(c,d,a,b,e){c.removeClass("toggleOpen").addClass("toggleClose");e==="home"&&$("#homePageFilterBarContainer").addClass("expandedFilterBar");d.css("display","none");if($(a).length==1&&i==-1)i=$(a).width();a.addClass("expandedContent");a.css("width","100%");b&&b.addClass("expandedContent")}function k(e,f,c,d,g){e.removeClass("toggleClose").addClass("toggleOpen");g==="home"&&$("#homePageFilterBarContainer").removeClass("expandedFilterBar");f.css("display","block");c.removeClass("expandedContent");c.css("width",i+"px");d&&d.removeClass("expandedContent");var b=$(".profile-userimage-large"),a=$(b).children("img:first");if($(a).length===1)$(a).width()===0&&$(a).width($(b).width())}function l(){p();o()}function p(){$(c).click(function(){m($(this),$(h),$(g),null,"home")});if(typeof localStorage[a]!=="undefined")if(localStorage[a]==="0")j($(c),$(h),$(g),null,"home");else k($(c),$(h),$(g),null,"home")}function o(){$(b).click(function(){m($(this),$(f),$(d),$(e),"thread")});if(typeof localStorage[a]!=="undefined")if(localStorage[a]==="0")j($(b),$(f),$(d),$(e));else k($(b),$(f),$(d),$(e))}$(function(){n()});return{setup:n,wireToggleButton:l}}();Forums.Leaderboards={seeMore:function(a){var b=$("#rail div.leaderboards");a++;if(a>4)a=0;var c=window.leaderBoardUrl+"&leaderBoard="+a;b.fadeTo("slow",.5);b.addClass("submitting");b.parent("div").load(c)}};Forums.Users={usersAction:function(a,b){return function(){$("img.icon",a).addClass("submitting");$.post($(a).attr("href"),b,function(){$(a).remove()},"json");return false}},blockAvatar:function(){var a=$(this);$(this).click(Forums.Users.usersAction(a,{blockAvatar:true}))},unblockAvatar:function(){var a=$(this);$(this).click(Forums.Users.usersAction(a,{blockAvatar:false}))},decorateUsers:function(){$("a[name='blockUnblockAvatar']",this).each(Forums.Users.blockAvatar)}};Forums.Common={TrackCustomClick:function(d,a,b,c){typeof t_omni_utils!=="undefined"&&t_omni_utils&&t_omni_utils.omniModTracking&&t_omni_utils.omniModTracking(true,d,"",a,b,c)},FixPartnerForumContextUrls:function(e){var c=$("#p_ApplicationUrl");if(typeof c!=="undefined"&&c){var d=$("#connect-context .home-link-container a",e);typeof d!=="undefined"&&d&&d.attr("href",c.attr("value"))}var a=$("#p_ApplicationForumContextUrl");if(typeof a!=="undefined"&&a){var b=$("#connect-context .connection-link-container a",e);if(typeof b!=="undefined"&&b)if(a.attr("value"))b.attr("href",a.attr("value"));else b.remove()}},ShowPrompt:function(c,a,b){this.clicked=true;$.prompt(c,{prefix:"spWarning",top:"40%",buttons:{closeButton:{title:a,value:true}},submit:function(){window.location.replace(b)}})}};$.addToRail=function(b,f){for(var c=$("#rail"),a=0;a<b.length;a++){var d=document.createElement("div");c.append(d);var e=b[a].indexOf("?")!=-1?"&":"?";if(b[a].indexOf("rightrailannouncement")!=-1)$(d).load(b[a]+e+"rnd="+Math.random(),null,function(){Forums.Common.FixPartnerForumContextUrls(c)});else $(d).load(b[a]+e+"rnd="+Math.random(),null,f);if(b[a].indexOf("leaderboards")!=-1)window.leaderBoardUrl=b[a]+e+"rnd="+Math.random()}c.append($(".help",c))};$.fn.popup=function(){$(this).each(function(){var b="a[name='"+$(this).attr("name")+"']",a="ul[name='"+$(this).attr("name")+"Popup']";$(this).find(Forums.Constants.ExpandCollapseImageRef).detach();$(this).append(Forums.Constants.ExpandCollapseImage);var c=function(){$("ul.popup").hide();$("body").unbind("click.popup")};$(this).click(function(d){$("ul.popup").hide();var f=$(a).width(),e=$(b).position();if($(a).attr("popupAlign")==="right")$(a).css("left",e.left+$(d.target).width()/2-f);else if($(a).attr("popupAlign")==="rightRail")$(a).css("right",$(b).offsetParent().width()-e.left);else $(a).css("left",e.left);var g=d.target.className=="expcol"?d.target.parentElement:d.target;$(a).css("top",e.top+$(g).height()*1.5);$(a).show();d.stopPropagation();$("body").bind("click.popup",c)})})};Forums.ManageRoles={selectAll:function(){if($("#selectAll").attr("checked"))$("input[name='userId']").attr("checked","checked");else $("input[name='userId']").attr("checked",false)}};$.fn.removeWatermark=function(){$(this).each(function(){if($(this).hasClass("watermark")){$(this).val("");$(this).removeClass("watermark")}})};$.removeAllWatermarks=function(){$(".watermark").each(function(){$(this).removeWatermark()})};$.fn.watermark=function(a){$(this).each(function(){$(this).removeWatermark();$(this).bind("click",function(){if($(this).hasClass("watermark")){$(this).val("");$(this).removeClass("watermark")}});$(this).bind("blur",function(){if($(this).val()==""||$(this).val()==a){$(this).addClass("watermark");$(this).val(a)}});$(this).blur()})};$.fn.watermarkVal=function(){return $(this).hasClass("watermark")?"":$(this).val()};$.fn.toggleVisibility=function(){var a="visible",b="invisible";if($(this).hasClass(a))$(this).removeClass(a).addClass(b);else $(this).removeClass(b).addClass(a)};$("input#ErrorSearchButton").live("click",function(){var b=$("input#ErrorSearchBox").val();if(!b)return;var a=$("input#SearchUri").val();if(!a)return;window.location.href=a.replace("{0}",escape(b))});Forums.Redirect=function(a){window.location.href=a};Forums.CommaSeparateAndAddListToUrl=function(a,c,b){if($(b).length>0)a+=(a.indexOf("?")>-1?"&":"?")+c+"="+encodeURIComponent(b.join(","));return a};Forums.BaseUrl=function(){return window.location.href.split("#")[0].split("?")[0]};Forums.GetJSONArray=function(a){if(a!="")try{return window.JSON?JSON.parse(a):$.parseJSON(a)}catch(b){}return[]};Forums.AppendQuestionOrAmpersandToUrl=function(a){if(a)a+=a.indexOf("?")!=-1?"&":"?";return a};Forums.ScrollWindowToTop=function(){window.scrollTo(0,0)};Forums.loadScript=function(a){$(document).ready(function(){$.ajax({async:true,type:"GET",url:a,data:null,dataType:"script",cache:true})})};jQuery.expr[":"].Contains=function(a,c,b){return jQuery(a).text().toUpperCase().indexOf(b[3].toUpperCase())>=0};