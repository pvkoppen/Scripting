<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xml:lang="en" xmlns="http://www.w3.org/1999/xhtml" lang="en"><head>


<meta content="text/html; charset=utf-8" http-equiv="content-type"><title>Using Windows Installer</title>

<meta content="python programming language object oriented web free source" name="keywords">
<meta content="Home page for Python, an interpreted, interactive, object-oriented, extensible programming language. It provides an extraordinary combination of clarity and versatility, and is free and comprehensively ported." name="description">
<link href="http://www.python.org/channews.rdf" type="application/rss+xml" rel="alternate" title="RSS">
<link media="screen" href="Using%20Windows%20Installer%20%28Python%29_files/screen-switcher-default.css" type="text/css" id="screen-switcher-stylesheet" rel="stylesheet">
<link media="scReen" href="Using%20Windows%20Installer%20%28Python%29_files/netscape4.css" type="text/css" rel="stylesheet">
<link media="print" href="Using%20Windows%20Installer%20%28Python%29_files/print.css" type="text/css" rel="stylesheet">
<link media="screen" href="Using%20Windows%20Installer%20%28Python%29_files/largestyles.css" type="text/css" rel="alternate stylesheet" title="large text">
<link media="screen" href="Using%20Windows%20Installer%20%28Python%29_files/defaultfonts.css" type="text/css" rel="alternate stylesheet" title="default fonts">
<script src="Using%20Windows%20Installer%20%28Python%29_files/iotbs2-key-directors-load.js" type="text/javascript"></script>
<script src="Using%20Windows%20Installer%20%28Python%29_files/iotbs2-directors.js" type="text/javascript"></script>
<script src="Using%20Windows%20Installer%20%28Python%29_files/iotbs2-core.js" type="text/javascript"></script></head><body>
  <!--  Logo  -->
  <h1 id="logoheader">
<a accesskey="1" href="http://www.python.org/" id="logolink"><img src="Using%20Windows%20Installer%20%28Python%29_files/python-logo.gif" alt="homepage" id="logo" border="0"></a>
</h1>
  <!--  Skip to Navigation  -->
  <div class="skiptonav"><a accesskey="2" href="#left-hand-navigation"><img src="Using%20Windows%20Installer%20%28Python%29_files/trans.gif" alt="skip to navigation" id="skiptonav" border="0"></a></div>
<div class="skiptonav"><a accesskey="3" href="#content-body"><img src="Using%20Windows%20Installer%20%28Python%29_files/trans.gif" alt="skip to content" id="skiptocontent" border="0"></a></div>
  <!--  Utility Menu  -->
  <div id="utility-menu">
    <!--  Search Box  -->
    <div id="searchbox">
<form action="http://google.com/search" id="searchform" method="get" name="searchform">
<div id="search">
<input id="domains" value="www.python.org" name="domains" type="hidden">
<input id="sitesearch" value="www.python.org" name="sitesearch" type="hidden">
<input id="sourceid" value="google-search" name="sourceid" type="hidden">
<input class="input-text" id="q" name="q" type="text">
<input class="input-button" name="submit" value="search" id="submit" type="submit">
<a href="http://www.python.org/search" class="reference">Advanced Search</a>
</div>
</form>
</div>
<div id="screen-switcher"><dl id="select-screen-switcher"><dt>Screen styles</dt><dd class="selected">normal*</dd><dd class=""><a href='javascript:void("largefonts", "large")'>large</a></dd><dd class=""><a href='javascript:void("defaultfonts", "userpref")'>userpref</a></dd></dl></div>
</div>
<div id="left-hand-navigation">
  
    <!--  Main Menu NEED LEVEL TWO HEADER AND FOOTER -->
    <div id="menu">
<ul class="level-one">
<li class=""><a href="http://www.python.org/about" class="" title="About The Python Language">About</a>
</li><li class=""><a href="http://www.python.org/news" class="" title="">News</a>
</li><li class=""><a href="http://www.python.org/doc" class="" title="">Documentation</a>
</li><li class="selected"><a href="http://www.python.org/download/" class="selected" title="">Download</a>
<ul class="level-two">
<li class="selected"><a href="http://www.python.org/download/releases/" class="selected" title="">Releases</a>
<ul class="level-three">
<li class=""><a href="http://www.python.org/download/releases/2.5" class="" title="">2.5 (beta)</a></li><li class=""><a href="http://www.python.org/download/releases/2.4.3" class="" title="">2.4.3</a></li><li class="selected"><a href="http://www.python.org/download/releases/2.4/" class="selected" title="">2.4</a></li><li class=""><a href="http://www.python.org/download/releases/2.3.5" class="" title="">2.3.5</a></li><li class=""><a href="http://www.python.org/download/releases/2.2.3" class="" title="">2.2.3</a></li><li class=""><a href="http://www.python.org/download/releases/2.1.3" class="" title="">2.1.3</a></li><li class=""><a href="http://www.python.org/download/releases/2.0.1" class="" title="">2.0.1</a></li><li class=""><a href="http://www.python.org/download/releases/1.6.1" class="" title="">1.6.1</a></li><li class=""><a href="http://www.python.org/download/releases/1.5" class="" title="">1.5.2</a></li>
</ul>
</li><li class=""><a href="http://www.python.org/download/windows" class="" title="">Windows, DOS</a>
</li><li class=""><a href="http://www.python.org/download/mac" class="" title="">Macintosh</a>
</li><li class=""><a href="http://www.python.org/download/linux" class="" title="">Linux</a>
</li><li class=""><a href="http://www.python.org/download/other" class="" title="">Other</a>
</li><li class=""><a href="http://www.python.org/download/source" class="" title="">Source</a>
</li><li class=""><a href="http://www.python.org/download/svn" class="" title="">SVN Access</a>
</li><li class=""><a href="http://www.python.org/download/contributed" class="" title="">Contributed Software</a>
</li>
</ul>
</li><li class=""><a href="http://www.python.org/community" class="" title="">Community</a>
</li><li class=""><a href="http://www.python.org/psf" class="" title="Python Software Foundation">PSF</a>
</li><li class=""><a href="http://www.python.org/links" class="" title="">Links</a>
</li><li class=""><a href="http://www.python.org/dev" class="" title="Python Core Language Development">Core Development</a>
</li><li class=""><a href="http://www.python.org/infogami-faq" class="" title="">FAQ in Development</a>
</li>
</ul>
</div>
    
    <!--  Quick Links  -->
    
      
      <h4><a href="http://www.python.org/download/releases/2.4.3">Quick Links (2.4.3)</a></h4>
<ul class="quicklinks">
<li class=""><a href="http://docs.python.org/">Documentation</a></li><li class=""><a href="http://www.python.org/ftp/python/2.4.3/python-2.4.3.msi">Windows Installer</a></li><li class=""><a href="http://www.python.org/ftp/python/2.4.3/Python-2.4.3.tar.bz2">Source Distribution</a></li><li class=""><a href="http://www.python.org/pypi">Package Index</a></li>
</ul>
<h4><a href="http://www.python.org/community/jobs">Python Jobs</a></h4>
<h4><a href="http://www.python.org/psf/donations">Donate to the PSF</a></h4>
<h4><a href="http://psf.pollenation.net/cgi-bin/trac.cgi/wiki/CreatingTickets">Report website bug</a></h4>
</div>
<div id="content-body">
<div id="body-main">
<div id="content">
<div id="breadcrumb"><a href="http://www.python.org/download/">Download</a> <span class="breadcrumb-separator">&gt;</span> <a href="http://www.python.org/download/releases/">Releases</a> <span class="breadcrumb-separator">&gt;</span> <a href="http://www.python.org/download/releases/2.4/">2.4</a> <span class="breadcrumb-separator">&gt;</span> Windows MSI Installer</div>
<div id="document-navigation">
<h4>Python 2.4</h4>
<ul class="level-one">
<li class=""><a href="http://www.python.org/download/releases/2.4/msi/highlights" class="">Highlights</a>
</li><li class=""><a href="http://www.python.org/download/releases/2.4/msi/notes" class="">Release Notes</a>
</li><li class=""><a href="http://www.python.org/download/releases/2.4/msi/bugs" class="">Bugs</a>
</li><li class=""><a href="http://www.python.org/download/releases/2.4/msi/license" class="">License</a>
</li><li class=""><a href="http://www.python.org/download/releases/2.4/msi/msi" class="">Windows MSI Installer</a>
</li><li class=""><a href="http://www.python.org/download/releases/2.4/msi/rpms" class="">Linux RPMSs</a>
</li>
</ul>
</div>
<h2>Installer Features</h2>

Python 2.4 is distributed as a Microsoft Installer (MSI) file
on Windows. Typically, packages are installed by double-clicking
them in the file explorer. However, with the msiexec.exe command
line utility, additional features are available, like non-interactive 
installation and administrative installation.

<h2><a name="automated">Non-interactive Installation</a></h2>
With the command line
<pre>  msiexec /i python&lt;version&gt;.msi
</pre>
installation can be initiated programmatically. Additional
parameters can be passed at the end of this command line, like

<pre>  msiexec /i python-2.4.msi TARGETDIR=r:\python24
</pre>
<h3>Limited user interface</h3>

The amount of user interface that installer displays can
be controlled with /q options, in particular:
<ul>
<li> /qn - No interface
  </li><li> /qb - Basic interface - just a small progress dialog
  </li><li> /qb! - Like /qb, but hide the Cancel button
  </li><li> /qr - Reduced interface - display all dialogs that
    don't require user interaction (skip all modal dialogs)
  </li><li> /qn+ - Like /qn, but display "Completed" dialog at the end
  </li><li> /qb+ - Like /qb, but display "Completed" dialog at the end
</li></ul>
<h3>Target directory</h3>
The property TARGETDIR determines the root directory of the Python
installation. For example, a different installation drive can
be specified with
<pre> TARGETDIR=R:\python24
</pre>
The default TARGETDIR is [WindowsVolume]Python&lt;version&gt;.

<p><em>Due to a bug in python-2.4.msi, installing into a target dir
that has a space in its name causes the IDLE and pydoc shortcuts
to <a href="http://www.python.org/download/releases/2.4/bugs">fail</a>.</em></p>
<h3>Installation for All Users</h3>
Adding
<pre>  ALLUSERS=1
</pre>
causes an installation for all users. By default, the non-interactive
installation install the package just for the current user, and the
interactive installation offers a dialog which defaults to "all users"
if the user is sufficiently privileged.

<h3>Feature Selection</h3>
A number of properties allow selection of features to be installed,
reinstalled, or removed. The set of features for the Python installer
is
<ul>
<li>DefaultFeature - install the interpreter proper, plus the core libraries
 </li><li>Extensions - register extensions (.py, .pyc, etc)
 </li><li>TclTk - install Tkinter, and IDLE
 </li><li>Documentation - install documentation
 </li><li>Tools - install the Tools/ directory
 </li><li>Testsuite - install Lib/test/
</li></ul>
In addition, ALL specifies all features. All features depend on
DefaultFeature, so installing any feature automatically installs the
default feature as well.
The following properties control features to be installed or removed
<ul>
<li>ADDLOCAL - list of feature to be installed on the local machine
 </li><li>REMOVE - list of features to be removed
 </li><li>ADDDEFAULT - list of features added in their default configuration
 (which is local for all Python features)
 </li><li>REINSTALL - list of features to be reinstalled/repaired
 </li><li>ADVERTISE - list of feature for which to perform an advertise installation
</li></ul>
There are a few additional properties available; see the MSDN documentation
for details.<p>
With these options, adding
</p><pre>  ADDLOCAL=Extensions
</pre>
installs the interpreter itself and registers the extensions, but does
not install anything else.

<h2>Uninstallation</h2>
With
<pre>  msiexec /x python&lt;version&gt;.msi
</pre>
python can be uninstalled. It is not necessary to have the
MSI file available for uninstallation; alternatively, the package
or product code can also be specified. You can find the product
code by looking at the properties of the Uninstall shortcut that
Python installs in the start menu.

<h2>Administrative installation</h2>
With
<pre>  msiexec /a python&lt;version&gt;.msi
</pre>
an "administrative" (network) installation can be initiated.
The files get unpacked into the target directory (which should
be a network directory), but no other modification is made to
the local system. In addition, another (smaller) msi file is
generated in the target directory, which clients can then use
to perform a local installation (future versions may also offer
to keep some features on the network drive altogether).<p>
Currently, there is no user interface for administrative installations,
so the target directory must be passed on the command line.</p><p>
There is no specific uninstall procedure for an administrative
install - just delete the target directory if no client uses
it anymore.

</p><h2>Advertisement</h2>
With
<pre>  msiexec /jm python&lt;version&gt;.msi
</pre>
it would be possible, in principle, to "advertise" python to a
machine (with /ju to a user). This would cause the icons to appear
in the start menu, and the extensions to become registered, without
the software actually being installed. The first usage of a feature
would cause that feature to be installed.<p>
<em style="color: brown;">The Python installer currently supports
just advertisement of start menu entries, but no advertisement
of shortcuts.</em>
</p><h2>Automatic Installation on a Group of Machines</h2>

With Windows Group Policy, it is possible to automatically install
Python an a group of machines. To do so, perform the following steps:
<ol>
<li>Log on to the domain controller
 </li><li>Copy the MSI file into a folder that is shared with access
 granted to all target machines.
 </li><li>Open the MMC snapin "Active Directory users and computers"
 </li><li>Navigate to the group of computers that need Python
 </li><li>Open Properties
 </li><li>Open Group Policies
 </li><li>Add a new polices, and edit it
 </li><li>In Computer Configuration/Software Installation, chose
     New/Package
 </li><li>Select the MSI file through the network path
 </li><li>Optionally, select that you want the Python to be deinstalled
 if the computer leaves the scope of the policy.
</li></ol>
Group policy propagation typically takes some time - to reliably deploy
the package, all machines should be rebooted.





</div>
<div id="footer"><div id="credits">
<a href="http://www.python.org/about/website">Website maintained by the Python community</a><br>
<a href="http://www.xs4all.com/" title="Web and email hosting provided by xs4all, Netherlands">hosting by xs4all</a> / 
  <a href="http://www.pollenation.net/" title="Design and content management system by Pollenation Internet, Yorkshire">design by pollenation</a>
</div>
Copyright © 1990-2006, <a href="http://www.python.org/psf">Python Software Foundation</a><br>
<a href="http://www.python.org/about/legal">Legal Statements</a>
</div>
</div>
</div>
</body></html>